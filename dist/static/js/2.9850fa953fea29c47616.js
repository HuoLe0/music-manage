webpackJsonp([2],{R5pI:function(t,e){},Us0B:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("BO1k"),r=i.n(n),o=i("Dd8w"),a=i.n(o),s=i("msXN"),l=i("NYxO"),c=(i("ttkU"),i("gyMJ")),d={mixins:[s.a],data:function(){return{singerId:"",singerName:"",centerDialogVisible:!1,editVisible:!1,delVisible:!1,registerForm:{name:"",singerName:"",introduction:"",lyric:""},form:{id:"",name:"",introduction:"",lyric:""},tableData:[],tempData:[],select_word:"",pageSize:5,currentPage:1,idx:-1,multipleSelection:[],toggle:!1}},computed:a()({},Object(l.b)(["isPlay"]),{data:function(){return this.tableData.slice((this.currentPage-1)*this.pageSize,this.currentPage*this.pageSize)}}),watch:{select_word:function(){if(""==this.select_word)this.tableData=this.tempData;else{this.tableData=[];var t=!0,e=!1,i=void 0;try{for(var n,o=r()(this.tempData);!(t=(n=o.next()).done);t=!0){var a=n.value;a.name.includes(this.select_word)&&this.tableData.push(a)}}catch(t){e=!0,i=t}finally{try{!t&&o.return&&o.return()}finally{if(e)throw i}}}}},created:function(){this.singerId=this.$route.query.id,this.singerName=this.$route.query.name,this.getData()},destroyed:function(){this.$store.commit("setIsPlay",!1)},methods:{handleCurrentChange:function(t){this.currentPage=t},getData:function(){var t=this;this.tempData=[],this.tableData=[],Object(c.u)(this.singerId).then(function(e){t.tempData=e,t.tableData=e,t.currentPage=1})},addSong:function(){var t=this,e=new FormData(document.getElementById("tf"));e.append("singerId",this.singerId),e.append("introduction",this.registerForm.introduction),e.set("name",this.registerForm.name+"-"+this.singerName),e.get("lyric")||e.set("lyric","[00:00:00]暂无歌词");var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){var e=JSON.parse(i.response);e.code?(t.getData(),t.registerForm={},t.notify(e.msg,"success")):t.notify("保存失败","error")}},i.open("post",t.$store.state.HOST+"/song/add",!1),i.send(e),t.centerDialogVisible=!1},handleEdit:function(t){this.editVisible=!0,this.form={id:t.id,name:t.name,introduction:t.introduction,lyric:t.lyric}},editSave:function(){var t=this,e=new URLSearchParams;e.append("id",this.form.id),e.append("name",this.form.name),e.append("introduction",this.form.introduction),e.append("lyric",this.form.lyric),Object(c.z)(e).then(function(e){1==e.code?(t.getData(),t.notify("修改成功","success")):t.notify("修改失败","error")}).catch(function(t){console.log(t)}),this.editVisible=!1},uploadUrl:function(t){return this.$store.state.HOST+"/song/updateSongPic?id="+t},deleteRow:function(){var t=this;Object(c.e)(this.idx).then(function(e){e?(t.getData(),t.notify("删除成功","success")):t.notify("删除失败","error")}).catch(function(t){console.log(t)}),this.delVisible=!1},parseLyric:function(t){var e=t.split("\n"),i=/\[\d{2}:\d{2}.(\d{3}|\d{2})\]/g,n=[],o=!0,a=!1,s=void 0;try{for(var l,c=r()(e);!(o=(l=c.next()).done);o=!0){var d=l.value.replace(i,"");n.push(d)}}catch(t){a=!0,s=t}finally{try{!o&&c.return&&c.return()}finally{if(a)throw s}}return n},beforeSongUpload:function(t){var e=t.name.substring(t.name.lastIndexOf(".")+1);return"flac"==e||("mp3"==e||("m4a"==e||(this.$message({message:"上传文件只能是mp3格式",type:"error"}),!1)))},handleSongSuccess:function(t){1==t.code?(this.getData(),this.$notify({title:"上传成功",type:"success"})):this.$notify({title:"上传失败",type:"error"})},uploadSongUrl:function(t){return this.$store.state.HOST+"/song/updateSongUrl?id="+t},setSongUrl:function(t,e){this.toggle=e,this.$store.commit("setUrl",this.$store.state.HOST+t),this.isPlay?this.$store.commit("setIsPlay",!1):this.$store.commit("setIsPlay",!0)}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"table"},[t._m(0),t._v(" "),i("div",{staticClass:"container"},[i("div",{staticClass:"handle-box"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.delAll}},[t._v("批量删除")]),t._v(" "),i("el-input",{staticClass:"handle-input",attrs:{size:"mini",placeholder:"请输入歌曲名"},model:{value:t.select_word,callback:function(e){t.select_word=e},expression:"select_word"}}),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){t.centerDialogVisible=!0}}},[t._v("添加歌曲")])],1)]),t._v(" "),i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{size:"mini",border:"",height:"680px",data:t.data},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"40"}}),t._v(" "),i("el-table-column",{attrs:{label:"歌曲图片",width:"110",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticClass:"song-img"},[i("img",{staticStyle:{width:"100%"},attrs:{src:t.getUrl(e.row.pic)}})]),t._v(" "),i("div",{staticClass:"play",on:{click:function(i){return t.setSongUrl(e.row.url,e.row.name)}}},[t.toggle==e.row.name?i("div",[i("svg",{staticClass:"icon"},[i("use",{attrs:{"xlink:href":"#icon-zanting"}})])]):t._e(),t._v(" "),t.toggle!=e.row.name?i("div",[i("svg",{staticClass:"icon"},[i("use",{attrs:{"xlink:href":"#icon-bofanganniu"}})])]):t._e()])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:"歌手-歌名",width:"120",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"introduction",label:"专辑",width:"150",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{label:"歌词",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("ul",{staticStyle:{height:"100px",overflow:"scroll"}},t._l(t.parseLyric(e.row.lyric),function(e,n){return i("li",{key:n},[t._v("\n                        "+t._s(e)+"\n                    ")])}),0)]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"资源更新",align:"center",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-upload",{attrs:{action:t.uploadUrl(e.row.id),"before-upload":t.beforeAvatorUpload,"on-success":t.handleAvatorSuccess}},[i("el-button",{attrs:{size:"mini"}},[t._v("更新图片")])],1),t._v(" "),i("br"),t._v(" "),i("el-upload",{attrs:{action:t.uploadSongUrl(e.row.id),"before-upload":t.beforeSongUpload,"on-success":t.handleSongSuccess}},[i("el-button",{attrs:{size:"mini"}},[t._v("更新歌曲")])],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){return t.handleEdit(e.row)}}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return t.handleDelete(e.row.id)}}},[t._v("删除")])]}}])})],1),t._v(" "),i("div",{staticClass:"pagination"},[i("el-pagination",{attrs:{background:"",layout:"total,prev,pager,next","current-page":t.currentPage,"page-size":t.pageSize,total:t.tableData.length},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),i("el-dialog",{attrs:{title:"添加歌曲",visible:t.centerDialogVisible,width:"400px",center:""},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[i("el-form",{ref:"registerForm",attrs:{model:t.registerForm,"label-width":"80px",action:"",id:"tf"}},[i("el-form-item",{attrs:{prop:"name",label:"歌名",size:"mini"}},[i("el-input",{attrs:{placeholder:"歌名"},model:{value:t.registerForm.name,callback:function(e){t.$set(t.registerForm,"name",e)},expression:"registerForm.name"}})],1),t._v(" "),i("el-form-item",{attrs:{prop:"introduction",label:"专辑",size:"mini"}},[i("el-input",{attrs:{placeholder:"专辑"},model:{value:t.registerForm.introduction,callback:function(e){t.$set(t.registerForm,"introduction",e)},expression:"registerForm.introduction"}})],1),t._v(" "),i("el-form-item",{attrs:{prop:"lyric",label:"歌词",size:"mini"}},[i("el-input",{attrs:{placeholder:"歌词",type:"textarea"},model:{value:t.registerForm.lyric,callback:function(e){t.$set(t.registerForm,"lyric",e)},expression:"registerForm.lyric"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"上传歌曲",size:"mini"}},[i("input",{attrs:{type:"file",name:"file"}})])],1),t._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(e){t.centerDialogVisible=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:t.addSong}},[t._v("确定")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"修改歌曲",visible:t.editVisible,width:"400px",center:""},on:{"update:visible":function(e){t.editVisible=e}}},[i("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[i("el-form-item",{attrs:{prop:"name",label:"歌手-歌名",size:"mini"}},[i("el-input",{attrs:{placeholder:"歌手-歌名"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),i("el-form-item",{attrs:{prop:"introduction",label:"专辑",size:"mini"}},[i("el-input",{attrs:{placeholder:"专辑"},model:{value:t.form.introduction,callback:function(e){t.$set(t.form,"introduction",e)},expression:"form.introduction"}})],1),t._v(" "),i("el-form-item",{attrs:{prop:"lyric",label:"歌词",size:"mini"}},[i("el-input",{attrs:{placeholder:"歌词",type:"textarea"},model:{value:t.form.lyric,callback:function(e){t.$set(t.form,"lyric",e)},expression:"form.lyric"}})],1)],1),t._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(e){t.editVisible=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:t.editSave}},[t._v("确定")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"删除歌曲",visible:t.delVisible,width:"300px",center:""},on:{"update:visible":function(e){t.delVisible=e}}},[i("div",{attrs:{align:"center"}},[t._v("删除不可恢复，是否确定删除？")]),t._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(e){t.delVisible=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{size:"mini"},on:{click:t.deleteRow}},[t._v("确定")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"crumbs"},[e("i",{staticClass:"el-icon-tickets"}),this._v("歌曲信息\n    ")])}]};var m=i("VU/8")(d,u,!1,function(t){i("R5pI")},"data-v-b6ad163a",null);e.default=m.exports},ttkU:function(t,e){!function(t){var e,i='<svg><symbol id="icon-bofanganniu" viewBox="0 0 1024 1024"><path d="M927.870095 571.688039 167.320423 1014.160886C121.562471 1041.981153 61.44 1007.279555 61.44 954.218179L61.44 68.595037C63.693916 16.802233 124.631347-17.041827 171.276012 8.961322L928.382003 451.43039C974.037627 479.202079 974.037627 543.611136 927.870095 571.688039Z"  ></path></symbol><symbol id="icon-zanting" viewBox="0 0 1024 1024"><path d="M268.97201558 114.31784297c73.21218086 0 132.56071902 59.34853814 132.56071901 132.560719v530.24287606c0 73.21218086-59.34853814 132.56071902-132.56071901 132.560719s-132.56071902-59.34853814-132.56071901-132.560719V246.87856197c0-73.21218086 59.34853814-132.56071902 132.56071901-132.560719z m486.05596884 0c73.21218086 0 132.56071902 59.34853814 132.56071901 132.560719v530.24287606c0 73.21218086-59.34853814 132.56071902-132.56071901 132.560719s-132.56071902-59.34853814-132.56071901-132.560719V246.87856197c0-73.21218086 59.34853814-132.56071902 132.56071901-132.560719z"  ></path></symbol></svg>';if((e=document.getElementsByTagName("script"))[e.length-1].getAttribute("data-injectcss")&&!t.__iconfont__svg__cssinject__){t.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(e){console&&console.log(e)}}!function(e){if(document.addEventListener)if(~["complete","loaded","interactive"].indexOf(document.readyState))setTimeout(e,0);else{document.addEventListener("DOMContentLoaded",function t(){document.removeEventListener("DOMContentLoaded",t,!1),e()},!1)}else document.attachEvent&&(n=e,r=t.document,o=!1,(a=function(){try{r.documentElement.doScroll("left")}catch(t){return void setTimeout(a,50)}i()})(),r.onreadystatechange=function(){"complete"==r.readyState&&(r.onreadystatechange=null,i())});function i(){o||(o=!0,n())}var n,r,o,a}(function(){var t,e;(t=document.createElement("div")).innerHTML=i,i=null,(e=t.getElementsByTagName("svg")[0])&&(e.setAttribute("aria-hidden","true"),e.style.position="absolute",e.style.width=0,e.style.height=0,e.style.overflow="hidden",function(t,e){e.firstChild?function(t,e){e.parentNode.insertBefore(t,e)}(t,e.firstChild):e.appendChild(t)}(e,document.body))})}(window)}});
//# sourceMappingURL=2.9850fa953fea29c47616.js.map